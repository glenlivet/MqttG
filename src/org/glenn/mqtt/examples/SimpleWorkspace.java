package org.glenn.mqtt.examples;

import java.io.UnsupportedEncodingException;

import org.glenn.mqtt.core.MqttConnectOptions;
import org.glenn.mqtt.core.MqttContext;
import org.glenn.mqtt.core.MqttSimpleClient;
import org.glenn.mqtt.core.MqttWorkspace;
import org.glenn.mqtt.core.exceptions.MqttTopicException;
import org.glenn.mqtt.core.exceptions.MqttUnacceptableQosException;
import org.glenn.mqtt.core.message.MqttMail;
import org.glenn.mqtt.core.message.MqttTopicFactory;
import org.glenn.mqtt.core.message.MqttTopicFactory.MqttTopic;

public class SimpleWorkspace implements MqttWorkspace {
	
	private MqttContext context;

	@Override
	public void mailArrived(MqttMail mail) {
		try {
			System.out.println("Topic: " + mail.getTopic().getTopic() + "  Payload" + new String(mail.getPayload(), "UTF-8"));
		} catch (UnsupportedEncodingException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}

	}

	@Override
	public void mailOnPubAck(int msgId) {
		System.out.println("PUBACK has just received on msgId = " + msgId);
		MqttSimpleClient client = MqttSimpleClient.getInstance();
		int i = client.publishPostman.size();
		System.out.println("publishPostman size : " + i);

	}

	@Override
	public void afterConnected() {
		try {
			MqttTopicFactory topicFac = new MqttTopicFactory();
			MqttTopic topic = topicFac.createTopic("_BROKER_/_INIT_/_CLIENT_INFO_");
			String content = "<payload><type>_NORMAL_MSG_</type><db_msg_id>Danie0113040200005</db_msg_id>" + 
								"<created_time>1304021200</created_time><content>This is my 1st message.</content></payload>";
			content = "<payload><type>_SYSTEM_MSG_</type><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info><client_info><client_id>client_id</client_id><username>username</username><password>password</password><subscription><topic>topic1</topic><qos>qos1</qos></subscription><subscription><topic>topic2</topic><qos>qos2</qos></subscription></client_info></payload>";
			
			byte[] payload = content.getBytes("UTF-8");
			MqttMail _mail = new MqttMail(topic, payload);
			_mail.setQos((byte) 0);
			context.sendMail(_mail);
			Thread.sleep(200);
			topic = topicFac.createTopic("_BROKER_/_INIT_/_CACHED_MSG_");
			content = "<?xml version=\"1.0\" encoding=\"UTF-8\"?><payload><type>_SYSTEM_MSG_</type><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg><cached_msg><db_msg_id>db_msg_id</db_msg_id><created_time>created_time</created_time><topic>topic</topic><content>content</content><publish_recipient><client_id>client_id</client_id><qos>qos</qos></publish_recipient><pubrel_recipient><client_id>client_id</client_id></pubrel_recipient></cached_msg></payload>";
			
			byte[] _pl = content.getBytes("UTF-8");
			MqttMail __mail = new MqttMail(topic, _pl);
			__mail.setQos((byte) 0);
			context.sendMail(__mail);
			
			
		} catch (MqttTopicException e) {
			// TODO: handle exception
		} catch (UnsupportedEncodingException e) {
			// TODO: handle exception
		} catch (MqttUnacceptableQosException e) {
			// TODO: handle exception
		} catch (InterruptedException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
	}
	
	public static void main(String[] args){
		String password = "000000";
		MqttConnectOptions connOpts = new MqttConnectOptions("MCXXX00", "MessageCentre", password.toCharArray(), 20);
		SimpleWorkspace workspace = new SimpleWorkspace();
		SimpleConnFailHandler mConnHandler = new SimpleConnFailHandler();
		workspace.context = MqttContext.getInstance("128.128.4.70", 11818, connOpts, workspace, mConnHandler);
		workspace.context.start();
	}

}
